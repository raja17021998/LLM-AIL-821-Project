  0%|                                                                          | 0/3780 [00:00<?, ?it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '   | 62.9M/135M [00:05<00:06, 11.6MB/s]
model.safetensors: 100%|█████████████████████████████████████████████| 135M/135M [00:12<00:00, 11.0MB/s]
  3%|█▋                                                              | 100/3780 [01:12<32:49,  1.87it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.6915, 'grad_norm': 47871.69921875, 'learning_rate': 4.933862433862434e-05, 'epoch': 0.26}
{'loss': 0.6825, 'grad_norm': 70506.8046875, 'learning_rate': 4.8677248677248676e-05, 'epoch': 0.53}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 0.6736570000648499, 'eval_accuracy': 0.6432593574031136, 'eval_runtime': 9.0855, 'eval_samples_per_second': 332.287, 'eval_steps_per_second': 5.283, 'epoch': 0.53}
  5%|███▍                                                            | 200/3780 [02:17<33:58,  1.76it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.6503, 'grad_norm': 397787.5, 'learning_rate': 4.801587301587302e-05, 'epoch': 0.79}
{'loss': 0.6479, 'grad_norm': 251917.921875, 'learning_rate': 4.7354497354497356e-05, 'epoch': 1.06}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 0.6530158519744873, 'eval_accuracy': 0.6333222921497185, 'eval_runtime': 9.7054, 'eval_samples_per_second': 311.065, 'eval_steps_per_second': 4.946, 'epoch': 1.06}
  8%|█████                                                           | 300/3780 [03:22<30:42,  1.89it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.6643, 'grad_norm': 312369.96875, 'learning_rate': 4.669312169312169e-05, 'epoch': 1.32}
{'loss': 0.6435, 'grad_norm': 190270.421875, 'learning_rate': 4.603174603174603e-05, 'epoch': 1.59}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 0.6797766089439392, 'eval_accuracy': 0.5710500165617755, 'eval_runtime': 9.8176, 'eval_samples_per_second': 307.51, 'eval_steps_per_second': 4.889, 'epoch': 1.59}
 11%|██████▊                                                         | 400/3780 [04:26<29:31,  1.91it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.6342, 'grad_norm': 222802.453125, 'learning_rate': 4.5370370370370374e-05, 'epoch': 1.85}
{'loss': 0.6195, 'grad_norm': 234268.171875, 'learning_rate': 4.470899470899471e-05, 'epoch': 2.12}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 0.6191156506538391, 'eval_accuracy': 0.6502153030804902, 'eval_runtime': 9.2348, 'eval_samples_per_second': 326.915, 'eval_steps_per_second': 5.198, 'epoch': 2.12}
 13%|████████▍                                                       | 500/3780 [05:30<30:26,  1.80it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.5976, 'grad_norm': 431387.53125, 'learning_rate': 4.404761904761905e-05, 'epoch': 2.38}
{'loss': 0.6022, 'grad_norm': 270472.59375, 'learning_rate': 4.3386243386243384e-05, 'epoch': 2.65}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 0.6193113923072815, 'eval_accuracy': 0.6700894335872806, 'eval_runtime': 9.8339, 'eval_samples_per_second': 306.999, 'eval_steps_per_second': 4.881, 'epoch': 2.65}
 16%|██████████▏                                                     | 600/3780 [06:36<29:15,  1.81it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.606, 'grad_norm': 234906.421875, 'learning_rate': 4.272486772486773e-05, 'epoch': 2.91}
{'loss': 0.5593, 'grad_norm': 277428.03125, 'learning_rate': 4.2063492063492065e-05, 'epoch': 3.17}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 0.6243619322776794, 'eval_accuracy': 0.6767141437562106, 'eval_runtime': 9.7772, 'eval_samples_per_second': 308.78, 'eval_steps_per_second': 4.909, 'epoch': 3.17}
 19%|███████████▊                                                    | 700/3780 [07:40<28:06,  1.83it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.5582, 'grad_norm': 354717.5, 'learning_rate': 4.14021164021164e-05, 'epoch': 3.44}
{'loss': 0.5741, 'grad_norm': 215956.140625, 'learning_rate': 4.074074074074074e-05, 'epoch': 3.7}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 0.5895192623138428, 'eval_accuracy': 0.6787015568068897, 'eval_runtime': 9.5629, 'eval_samples_per_second': 315.7, 'eval_steps_per_second': 5.019, 'epoch': 3.7}
 21%|█████████████▌                                                  | 800/3780 [08:44<27:00,  1.84it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.5472, 'grad_norm': 202073.0, 'learning_rate': 4.007936507936508e-05, 'epoch': 3.97}
{'loss': 0.5037, 'grad_norm': 236124.125, 'learning_rate': 3.941798941798942e-05, 'epoch': 4.23}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 0.5734651684761047, 'eval_accuracy': 0.6873136800264988, 'eval_runtime': 9.699, 'eval_samples_per_second': 311.268, 'eval_steps_per_second': 4.949, 'epoch': 4.23}
 24%|███████████████▏                                                | 900/3780 [09:48<26:17,  1.83it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.4904, 'grad_norm': 325341.53125, 'learning_rate': 3.8756613756613755e-05, 'epoch': 4.5}
{'loss': 0.5099, 'grad_norm': 616579.75, 'learning_rate': 3.809523809523809e-05, 'epoch': 4.76}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 0.5996662378311157, 'eval_accuracy': 0.6803577343491223, 'eval_runtime': 9.7, 'eval_samples_per_second': 311.239, 'eval_steps_per_second': 4.948, 'epoch': 4.76}
 26%|████████████████▋                                              | 1000/3780 [10:52<25:02,  1.85it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.4984, 'grad_norm': 305819.375, 'learning_rate': 3.7433862433862436e-05, 'epoch': 5.03}
{'loss': 0.4069, 'grad_norm': 343520.875, 'learning_rate': 3.677248677248677e-05, 'epoch': 5.29}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 0.6699069142341614, 'eval_accuracy': 0.6757204372308712, 'eval_runtime': 8.7489, 'eval_samples_per_second': 345.072, 'eval_steps_per_second': 5.486, 'epoch': 5.29}
 29%|██████████████████▎                                            | 1100/3780 [11:50<21:58,  2.03it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.4081, 'grad_norm': 274912.125, 'learning_rate': 3.611111111111111e-05, 'epoch': 5.56}
{'loss': 0.4416, 'grad_norm': 344715.34375, 'learning_rate': 3.5449735449735446e-05, 'epoch': 5.82}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 0.595395565032959, 'eval_accuracy': 0.6588274263000994, 'eval_runtime': 8.3858, 'eval_samples_per_second': 360.015, 'eval_steps_per_second': 5.724, 'epoch': 5.82}
 32%|████████████████████                                           | 1200/3780 [12:48<21:04,  2.04it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.388, 'grad_norm': 654660.75, 'learning_rate': 3.478835978835979e-05, 'epoch': 6.08}
{'loss': 0.3077, 'grad_norm': 856789.0625, 'learning_rate': 3.412698412698413e-05, 'epoch': 6.35}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 0.7643650770187378, 'eval_accuracy': 0.6502153030804902, 'eval_runtime': 8.5338, 'eval_samples_per_second': 353.769, 'eval_steps_per_second': 5.625, 'epoch': 6.35}
 34%|█████████████████████▋                                         | 1300/3780 [13:51<21:46,  1.90it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.2929, 'grad_norm': 367358.71875, 'learning_rate': 3.3465608465608464e-05, 'epoch': 6.61}
{'loss': 0.2944, 'grad_norm': 480542.9375, 'learning_rate': 3.280423280423281e-05, 'epoch': 6.88}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 0.8023501038551331, 'eval_accuracy': 0.6714143756210665, 'eval_runtime': 9.4538, 'eval_samples_per_second': 319.342, 'eval_steps_per_second': 5.077, 'epoch': 6.88}
 37%|███████████████████████▎                                       | 1400/3780 [14:51<19:50,  2.00it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.2807, 'grad_norm': 367087.5, 'learning_rate': 3.2142857142857144e-05, 'epoch': 7.14}
{'loss': 0.2062, 'grad_norm': 872830.625, 'learning_rate': 3.148148148148148e-05, 'epoch': 7.41}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 1.0453964471817017, 'eval_accuracy': 0.6442530639284532, 'eval_runtime': 8.5626, 'eval_samples_per_second': 352.58, 'eval_steps_per_second': 5.606, 'epoch': 7.41}
 40%|█████████████████████████                                      | 1500/3780 [15:48<19:01,  2.00it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.2093, 'grad_norm': 926132.8125, 'learning_rate': 3.0820105820105824e-05, 'epoch': 7.67}
{'loss': 0.1933, 'grad_norm': 596227.75, 'learning_rate': 3.0158730158730158e-05, 'epoch': 7.94}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 0.9918694496154785, 'eval_accuracy': 0.6508777740973832, 'eval_runtime': 8.6353, 'eval_samples_per_second': 349.611, 'eval_steps_per_second': 5.559, 'epoch': 7.94}
 42%|██████████████████████████▋                                    | 1600/3780 [16:46<17:33,  2.07it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.1425, 'grad_norm': 1438996.0, 'learning_rate': 2.94973544973545e-05, 'epoch': 8.2}
{'loss': 0.1326, 'grad_norm': 1667932.125, 'learning_rate': 2.8835978835978838e-05, 'epoch': 8.47}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 1.2472013235092163, 'eval_accuracy': 0.6598211328254389, 'eval_runtime': 8.6452, 'eval_samples_per_second': 349.21, 'eval_steps_per_second': 5.552, 'epoch': 8.47}
 45%|████████████████████████████▎                                  | 1700/3780 [17:44<17:18,  2.00it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.154, 'grad_norm': 385338.25, 'learning_rate': 2.8174603174603175e-05, 'epoch': 8.73}
{'loss': 0.1253, 'grad_norm': 446680.65625, 'learning_rate': 2.7513227513227512e-05, 'epoch': 8.99}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 1.297550916671753, 'eval_accuracy': 0.6366346472341835, 'eval_runtime': 8.4856, 'eval_samples_per_second': 355.777, 'eval_steps_per_second': 5.657, 'epoch': 8.99}
 48%|██████████████████████████████                                 | 1800/3780 [18:42<16:29,  2.00it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.0774, 'grad_norm': 15734.271484375, 'learning_rate': 2.6851851851851855e-05, 'epoch': 9.26}
{'loss': 0.1306, 'grad_norm': 1441940.0, 'learning_rate': 2.6190476190476192e-05, 'epoch': 9.52}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 1.4238672256469727, 'eval_accuracy': 0.6614773103676714, 'eval_runtime': 8.4726, 'eval_samples_per_second': 356.323, 'eval_steps_per_second': 5.665, 'epoch': 9.52}
 50%|███████████████████████████████▋                               | 1900/3780 [19:40<15:39,  2.00it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.0906, 'grad_norm': 615417.0, 'learning_rate': 2.552910052910053e-05, 'epoch': 9.79}
{'loss': 0.0737, 'grad_norm': 97535.3203125, 'learning_rate': 2.4867724867724866e-05, 'epoch': 10.05}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 1.689801812171936, 'eval_accuracy': 0.6505465385889367, 'eval_runtime': 8.8615, 'eval_samples_per_second': 340.687, 'eval_steps_per_second': 5.417, 'epoch': 10.05}
 53%|█████████████████████████████████▎                             | 2000/3780 [20:38<14:25,  2.06it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.0686, 'grad_norm': 907329.3125, 'learning_rate': 2.4206349206349206e-05, 'epoch': 10.32}
{'loss': 0.0863, 'grad_norm': 2077693.875, 'learning_rate': 2.3544973544973546e-05, 'epoch': 10.58}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 1.974025845527649, 'eval_accuracy': 0.6647896654521365, 'eval_runtime': 9.0212, 'eval_samples_per_second': 334.655, 'eval_steps_per_second': 5.321, 'epoch': 10.58}
 56%|███████████████████████████████████                            | 2100/3780 [21:18<09:17,  3.01it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.1074, 'grad_norm': 717528.8125, 'learning_rate': 2.2883597883597886e-05, 'epoch': 10.85}
{'loss': 0.0927, 'grad_norm': 373830.875, 'learning_rate': 2.2222222222222223e-05, 'epoch': 11.11}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 1.7788090705871582, 'eval_accuracy': 0.6598211328254389, 'eval_runtime': 5.8077, 'eval_samples_per_second': 519.828, 'eval_steps_per_second': 8.265, 'epoch': 11.11}
 58%|████████████████████████████████████▋                          | 2200/3780 [21:58<08:44,  3.01it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.0651, 'grad_norm': 131288.359375, 'learning_rate': 2.1560846560846563e-05, 'epoch': 11.38}
{'loss': 0.0814, 'grad_norm': 234146.5, 'learning_rate': 2.08994708994709e-05, 'epoch': 11.64}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 1.7844784259796143, 'eval_accuracy': 0.6581649552832064, 'eval_runtime': 5.799, 'eval_samples_per_second': 520.607, 'eval_steps_per_second': 8.277, 'epoch': 11.64}
 61%|██████████████████████████████████████▎                        | 2300/3780 [22:36<08:10,  3.01it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.0782, 'grad_norm': 76313.2890625, 'learning_rate': 2.023809523809524e-05, 'epoch': 11.9}
{'loss': 0.046, 'grad_norm': 224887.328125, 'learning_rate': 1.9576719576719577e-05, 'epoch': 12.17}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 1.8504137992858887, 'eval_accuracy': 0.663795958926797, 'eval_runtime': 5.8218, 'eval_samples_per_second': 518.567, 'eval_steps_per_second': 8.245, 'epoch': 12.17}
 63%|████████████████████████████████████████                       | 2400/3780 [23:16<07:41,  2.99it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.0638, 'grad_norm': 1709645.0, 'learning_rate': 1.8915343915343918e-05, 'epoch': 12.43}
{'loss': 0.0526, 'grad_norm': 114195.8671875, 'learning_rate': 1.8253968253968254e-05, 'epoch': 12.7}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 2.6390390396118164, 'eval_accuracy': 0.6591586618085459, 'eval_runtime': 5.8183, 'eval_samples_per_second': 518.878, 'eval_steps_per_second': 8.25, 'epoch': 12.7}
 66%|█████████████████████████████████████████▋                     | 2500/3780 [23:56<07:49,  2.73it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.0994, 'grad_norm': 27419.068359375, 'learning_rate': 1.7592592592592595e-05, 'epoch': 12.96}
{'loss': 0.0659, 'grad_norm': 62.0638542175293, 'learning_rate': 1.693121693121693e-05, 'epoch': 13.23}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 3.2950901985168457, 'eval_accuracy': 0.6604836038423318, 'eval_runtime': 6.4944, 'eval_samples_per_second': 464.863, 'eval_steps_per_second': 7.391, 'epoch': 13.23}
 69%|███████████████████████████████████████████▎                   | 2600/3780 [24:43<08:03,  2.44it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.0892, 'grad_norm': 2696044.5, 'learning_rate': 1.626984126984127e-05, 'epoch': 13.49}
{'loss': 0.0813, 'grad_norm': 72838.3828125, 'learning_rate': 1.560846560846561e-05, 'epoch': 13.76}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 3.783036947250366, 'eval_accuracy': 0.6618085458761179, 'eval_runtime': 6.6981, 'eval_samples_per_second': 450.726, 'eval_steps_per_second': 7.166, 'epoch': 13.76}
 71%|█████████████████████████████████████████████                  | 2700/3780 [25:28<06:43,  2.68it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.104, 'grad_norm': 7.861451148986816, 'learning_rate': 1.4947089947089949e-05, 'epoch': 14.02}
{'loss': 0.0874, 'grad_norm': 2474470.5, 'learning_rate': 1.4285714285714285e-05, 'epoch': 14.29}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 4.745689392089844, 'eval_accuracy': 0.6631334879099039, 'eval_runtime': 6.8651, 'eval_samples_per_second': 439.759, 'eval_steps_per_second': 6.992, 'epoch': 14.29}
 74%|██████████████████████████████████████████████▋                | 2800/3780 [26:14<06:15,  2.61it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.0763, 'grad_norm': 320595.25, 'learning_rate': 1.3624338624338626e-05, 'epoch': 14.55}
{'loss': 0.1057, 'grad_norm': 382825.59375, 'learning_rate': 1.2962962962962962e-05, 'epoch': 14.81}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 4.956550121307373, 'eval_accuracy': 0.666445842994369, 'eval_runtime': 6.7274, 'eval_samples_per_second': 448.76, 'eval_steps_per_second': 7.135, 'epoch': 14.81}
 77%|████████████████████████████████████████████████▎              | 2900/3780 [26:59<05:57,  2.46it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.0794, 'grad_norm': 42167.140625, 'learning_rate': 1.2301587301587301e-05, 'epoch': 15.08}
{'loss': 0.0442, 'grad_norm': 111.22708892822266, 'learning_rate': 1.164021164021164e-05, 'epoch': 15.34}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 5.150049686431885, 'eval_accuracy': 0.6720768466379596, 'eval_runtime': 6.6851, 'eval_samples_per_second': 451.599, 'eval_steps_per_second': 7.18, 'epoch': 15.34}
 79%|██████████████████████████████████████████████████             | 3000/3780 [27:45<04:57,  2.62it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.0818, 'grad_norm': 7438748.5, 'learning_rate': 1.0978835978835978e-05, 'epoch': 15.61}
{'loss': 0.09, 'grad_norm': 0.29305535554885864, 'learning_rate': 1.0317460317460318e-05, 'epoch': 15.87}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 5.238879203796387, 'eval_accuracy': 0.6578337197747599, 'eval_runtime': 6.869, 'eval_samples_per_second': 439.508, 'eval_steps_per_second': 6.988, 'epoch': 15.87}
 82%|███████████████████████████████████████████████████▋           | 3100/3780 [28:31<04:13,  2.68it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.0844, 'grad_norm': 0.21164047718048096, 'learning_rate': 9.656084656084657e-06, 'epoch': 16.14}
{'loss': 0.0548, 'grad_norm': 0.14379175007343292, 'learning_rate': 8.994708994708995e-06, 'epoch': 16.4}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 5.2255706787109375, 'eval_accuracy': 0.66445842994369, 'eval_runtime': 6.8377, 'eval_samples_per_second': 441.524, 'eval_steps_per_second': 7.02, 'epoch': 16.4}
 85%|█████████████████████████████████████████████████████▎         | 3200/3780 [29:12<03:12,  3.02it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.0882, 'grad_norm': 4.015585899353027, 'learning_rate': 8.333333333333334e-06, 'epoch': 16.67}
{'loss': 0.0722, 'grad_norm': 0.18215690553188324, 'learning_rate': 7.671957671957672e-06, 'epoch': 16.93}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 5.32396125793457, 'eval_accuracy': 0.6581649552832064, 'eval_runtime': 5.795, 'eval_samples_per_second': 520.97, 'eval_steps_per_second': 8.283, 'epoch': 16.93}
 87%|███████████████████████████████████████████████████████        | 3300/3780 [29:51<02:39,  3.01it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.0534, 'grad_norm': 0.3191123306751251, 'learning_rate': 7.010582010582011e-06, 'epoch': 17.2}
{'loss': 0.064, 'grad_norm': 74971.0234375, 'learning_rate': 6.349206349206349e-06, 'epoch': 17.46}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 5.35610818862915, 'eval_accuracy': 0.6621397813845644, 'eval_runtime': 5.8039, 'eval_samples_per_second': 520.167, 'eval_steps_per_second': 8.27, 'epoch': 17.46}
 90%|████████████████████████████████████████████████████████▋      | 3400/3780 [30:30<02:05,  3.02it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.0474, 'grad_norm': 0.15042904019355774, 'learning_rate': 5.687830687830688e-06, 'epoch': 17.72}
{'loss': 0.0867, 'grad_norm': 1.1179327964782715, 'learning_rate': 5.026455026455026e-06, 'epoch': 17.99}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 5.298351764678955, 'eval_accuracy': 0.6667770785028155, 'eval_runtime': 5.7804, 'eval_samples_per_second': 522.283, 'eval_steps_per_second': 8.304, 'epoch': 17.99}
 93%|██████████████████████████████████████████████████████████▎    | 3500/3780 [31:09<01:32,  3.03it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.0609, 'grad_norm': 114846.71875, 'learning_rate': 4.365079365079365e-06, 'epoch': 18.25}
{'loss': 0.0655, 'grad_norm': 0.24194841086864471, 'learning_rate': 3.7037037037037037e-06, 'epoch': 18.52}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 5.369752407073975, 'eval_accuracy': 0.6624710168930109, 'eval_runtime': 5.7903, 'eval_samples_per_second': 521.391, 'eval_steps_per_second': 8.29, 'epoch': 18.52}
 95%|████████████████████████████████████████████████████████████   | 3600/3780 [31:49<00:59,  3.02it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.0713, 'grad_norm': 0.1775921732187271, 'learning_rate': 3.0423280423280423e-06, 'epoch': 18.78}
{'loss': 0.0499, 'grad_norm': 9700543.0, 'learning_rate': 2.3809523809523808e-06, 'epoch': 19.05}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 5.324343681335449, 'eval_accuracy': 0.6604836038423318, 'eval_runtime': 5.7959, 'eval_samples_per_second': 520.886, 'eval_steps_per_second': 8.282, 'epoch': 19.05}
 98%|█████████████████████████████████████████████████████████████▋ | 3700/3780 [32:28<00:26,  3.02it/s]/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
{'loss': 0.041, 'grad_norm': 0.24035751819610596, 'learning_rate': 1.7195767195767195e-06, 'epoch': 19.31}
{'loss': 0.0553, 'grad_norm': 0.055400244891643524, 'learning_rate': 1.0582010582010582e-06, 'epoch': 19.58}
  warnings.warn('Was asked to gather along dimension 0, but all '                                       
{'eval_loss': 5.355460166931152, 'eval_accuracy': 0.6628022524014574, 'eval_runtime': 5.7819, 'eval_samples_per_second': 522.143, 'eval_steps_per_second': 8.302, 'epoch': 19.58}
100%|███████████████████████████████████████████████████████████████| 3780/3780 [32:55<00:00,  1.91it/s]
{'loss': 0.048, 'grad_norm': 0.11121782660484314, 'learning_rate': 3.9682539682539683e-07, 'epoch': 19.84}
{'train_runtime': 1976.642, 'train_samples_per_second': 122.177, 'train_steps_per_second': 1.912, 'train_loss': 0.2428762648471449, 'epoch': 20.0}
Evaluation on English validation set:
/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
100%|███████████████████████████████████████████████████████████████████| 48/48 [00:05<00:00,  8.97it/s]
Accuracy on English validation set: 0.6757204372308712
Evaluation on Bengali dataset:
/home/pooja/anaconda3/envs/kg_rag/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
100%|███████████████████████████████████████████████████████████████████| 48/48 [00:05<00:00,  8.71it/s]
Accuracy on Bengali test data: 0.544551175886055
